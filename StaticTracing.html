<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>module StaticTracing - RDoc Documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "./";
  var index_rel_prefix = "./";
</script>

<script src="./js/jquery.js"></script>
<script src="./js/darkfish.js"></script>

<link href="./css/fonts.css" rel="stylesheet">
<link href="./css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="module">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="./index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="./table_of_contents.html#pages">Pages</a>
    <a href="./table_of_contents.html#classes">Classes</a>
    <a href="./table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    
    
    
    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-i-configure">#configure</a>
    
    <li ><a href="#method-i-disable-21">#disable!</a>
    
    <li ><a href="#method-i-enable-21">#enable!</a>
    
    <li ><a href="#method-i-enabled-3F">#enabled?</a>
    
    <li ><a href="#method-i-issue_disabled_tracepoints_warning">#issue_disabled_tracepoints_warning</a>
    
    <li ><a href="#method-i-nsec">#nsec</a>
    
    <li ><a href="#method-i-toggle_tracing-21">#toggle_tracing!</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="module-StaticTracing">
  <h1 id="module-StaticTracing" class="module">
    module StaticTracing
  </h1>

  <section class="description">
    
<p>FIXME: Including <a href="StaticTracing.html">StaticTracing</a> should
cause every method in a module or class to be registered Implement this by
introspecting all methods on the includor, and wrapping them.</p>

  </section>

  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    
    <section class="constants-list">
      <header>
        <h3>Constants</h3>
      </header>
      <dl>
      
        <dt id="BaseError">BaseError
        
        <dd>
        
      
        <dt id="InternalError">InternalError
        
        <dd>
        
      
        <dt id="USDTError">USDTError
        
        <dd>
        
      
        <dt id="VERSION">VERSION
        
        <dd><p>The current version of this gem</p>
        
      
      </dl>
    </section>
    

    
    <section class="attribute-method-details" class="method-section">
      <header>
        <h3>Attributes</h3>
      </header>

      
      <div id="attribute-i-logger" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">logger</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
    </section>
    

    
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

    
      <div id="method-i-configure" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">configure</span><span
            class="method-args">() { |instance| ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Block to configure static tracing, eg:</p>

<pre class="ruby"><span class="ruby-constant">StaticTracing</span>.<span class="ruby-identifier">configure</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">config</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">config</span>.<span class="ruby-identifier">add_tracer</span>(<span class="ruby-constant">StaticTracing</span><span class="ruby-operator">::</span><span class="ruby-constant">Tracer</span><span class="ruby-operator">::</span><span class="ruby-constant">Latency</span>)
<span class="ruby-keyword">end</span>
</pre>
          
          

          
          <div class="method-source-code" id="configure-source">
            <pre><span class="ruby-comment"># File lib/ruby-static-tracing.rb, line 72</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">configure</span>
  <span class="ruby-keyword">yield</span> <span class="ruby-constant">Configuration</span>.<span class="ruby-identifier">instance</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-disable-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">disable!</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Overwrite the definition of all functions to their original definition, no
longer wrapping them</p>
          
          

          
          <div class="method-source-code" id="disable-21-source">
            <pre><span class="ruby-comment"># File lib/ruby-static-tracing.rb, line 56</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">disable!</span>
  <span class="ruby-constant">StaticTracing</span><span class="ruby-operator">::</span><span class="ruby-constant">Tracers</span>.<span class="ruby-identifier">disable!</span>
  <span class="ruby-constant">StaticTracing</span><span class="ruby-operator">::</span><span class="ruby-constant">Provider</span>.<span class="ruby-identifier">disable!</span> <span class="ruby-comment"># FIXME dangerous</span>
  <span class="ruby-ivar">@enabled</span> = <span class="ruby-keyword">false</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-enable-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">enable!</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Overwrite the definition of all functions that are enabled with a wrapped
version that has tracing enabled</p>
          
          

          
          <div class="method-source-code" id="enable-21-source">
            <pre><span class="ruby-comment"># File lib/ruby-static-tracing.rb, line 48</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">enable!</span>
  <span class="ruby-constant">StaticTracing</span><span class="ruby-operator">::</span><span class="ruby-constant">Tracers</span>.<span class="ruby-identifier">enable!</span>
  <span class="ruby-constant">StaticTracing</span><span class="ruby-operator">::</span><span class="ruby-constant">Provider</span>.<span class="ruby-identifier">enable!</span> <span class="ruby-comment"># FIXME individually call enable</span>
  <span class="ruby-ivar">@enabled</span> = <span class="ruby-keyword">true</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-enabled-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">enabled?</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Should indicate if static tracing is enabled - a global constant</p>
          
          

          
          <div class="method-source-code" id="enabled-3F-source">
            <pre><span class="ruby-comment"># File lib/ruby-static-tracing.rb, line 42</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">enabled?</span>
  <span class="ruby-operator">!</span><span class="ruby-operator">!</span><span class="ruby-ivar">@enabled</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-issue_disabled_tracepoints_warning" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">issue_disabled_tracepoints_warning</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>This will print a message indicating that tracepoints are disabled on this
platform</p>
          
          

          
          <div class="method-source-code" id="issue_disabled_tracepoints_warning-source">
            <pre><span class="ruby-comment"># File lib/ruby-static-tracing.rb, line 26</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">issue_disabled_tracepoints_warning</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-ivar">@warning_issued</span>)

  <span class="ruby-ivar">@warning_issued</span> = <span class="ruby-keyword">true</span>
  <span class="ruby-identifier">logger</span>.<span class="ruby-identifier">info</span>(<span class="ruby-node">&quot;USDT tracepoints are not presently supported supported on #{RUBY_PLATFORM} - all operations will no-op&quot;</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-nsec" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">nsec</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Efficiently return the current monotonic clocktime. Wraps libc
clock_gettime The overhead of this is tested to be on the order of 10
microseconds under normal conditions You should inline this method in your
tracer to avoid an extra method call.</p>
          
          

          
          <div class="method-source-code" id="nsec-source">
            <pre><span class="ruby-comment"># File lib/ruby-static-tracing.rb, line 37</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">nsec</span>
  <span class="ruby-constant">Process</span>.<span class="ruby-identifier">clock_gettime</span>(<span class="ruby-constant">Process</span><span class="ruby-operator">::</span><span class="ruby-constant">CLOCK_MONOTONIC</span>, <span class="ruby-value">:nanosecond</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-toggle_tracing-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">toggle_tracing!</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Toggles between enabling and disabling tracepoints declared through tracers</p>
          
          

          
          <div class="method-source-code" id="toggle_tracing-21-source">
            <pre><span class="ruby-comment"># File lib/ruby-static-tracing.rb, line 63</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">toggle_tracing!</span>
  <span class="ruby-identifier">enabled?</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">disable!</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">enable!</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="https://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://ruby.github.io/rdoc/">RDoc</a> 6.0.1.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

